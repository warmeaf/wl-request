# wl-request 技术文档

## 项目概述

wl-request 是一个基于 TypeScript 的现代化请求库，**专为浏览器环境设计**，采用分层架构设计，提供统一的请求接口和丰富的功能特性。通过适配器模式支持多种请求库（fetch、axios 等），同时提供请求重试、缓存、并行/串行请求、幂等请求等高级功能。

**重要说明：** 本库仅支持浏览器端使用，不支持 Node.js 等服务器端环境。库中使用的浏览器 API（如 `localStorage`、`IndexedDB`、`fetch` 等）在 Node.js 环境中不可用。

## 核心特性

- **浏览器端专用**：专为浏览器环境设计，充分利用浏览器 API（localStorage、IndexedDB、fetch 等），不支持 Node.js 等服务器端环境
- **分层架构**：基于 TypeScript，清晰的代码组织结构
- **适配器模式**：完全兼容适配对象（fetch、axios 等），每个适配器是一个独立的包。默认是 fetch 适配器，无需额外安装
- **缓存适配器**：支持多种缓存存储方式（内存、IndexedDB），需要显式指定缓存适配器才能使用缓存功能
- **高级功能**：请求重试、请求缓存、并行请求、串行请求、幂等请求
- **设计原则**：适配器与核心模块的依赖关系遵循依赖倒置原则，提高代码的可维护性和可扩展性
- **构建工具**：基于 Vite 构建，提供极速的开发体验和优化的生产构建
- **测试框架**：使用 Vitest 进行单元测试和集成测试，确保代码质量和稳定性
- **使用方式**：hook 式使用方式，符合现代前端开发习惯

## 项目文件结构

```
wl-request/
├── packages/
│   ├── core/                    # 核心包（包含默认的 Fetch 适配器）
│   │   ├── src/
│   │   │   ├── types/           # 类型定义
│   │   │   ├── interfaces/     # 接口定义
│   │   │   ├── adapters/        # 适配器抽象层和 Fetch 适配器
│   │   │   ├── features/        # 功能模块（重试、缓存等）
│   │   │   ├── hooks/           # Hook 实现
│   │   │   └── index.ts         # 入口文件
│   │   ├── tests/               # 单元测试
│   │   └── package.json
│   │
│   ├── adapter-axios/           # Axios 适配器（可选）
│   │   ├── src/
│   │   │   └── index.ts
│   │   ├── tests/
│   │   └── package.json
│   │
│   ├── cache-adapter-memory/    # 内存缓存适配器
│   │   ├── src/
│   │   │   └── index.ts
│   │   └── package.json
│   │
│   ├── cache-adapter-indexeddb/ # IndexedDB 缓存适配器
│   │   ├── src/
│   │   │   └── index.ts
│   │   └── package.json
│   │
│   └── ...                      # 其他适配器
│
├── docs/                        # 文档目录
│   ├── 技术文档.md              # 本文档（索引）
│   ├── getting-started.md       # 快速开始
│   ├── usage-examples.md        # 使用示例
│   ├── engineering-tools.md     # 工程化工具
│   ├── architecture.md          # 架构设计
│   └── testing.md               # 测试
│
├── examples/                    # 使用示例
├── tests/                       # 集成测试
├── .husky/                      # Git hooks 目录
├── biome.json                   # Biome 配置
├── commitlint.config.js         # Commitlint 配置
├── .lintstagedrc.js            # Lint-staged 配置
├── vite.config.ts               # Vite 构建配置
├── vitest.config.ts             # Vitest 测试配置
├── tsconfig.json                # TypeScript 配置
├── pnpm-workspace.yaml          # pnpm workspace 配置
└── package.json                  # 根 package.json（monorepo）
```

## 文档导航

本文档已按主题拆分为多个子文档，方便查阅和维护：

### 快速开始

- **[快速开始](./getting-started.md)** - 基础使用示例和快速上手指南
  - 基础使用（Vue 组件示例）
  - 全局配置基础说明

### 使用指南

- **[使用示例](./usage-examples.md)** - 详细的使用示例和配置说明
  - 全局配置详细说明
  - 请求重试
  - 请求缓存
  - 缓存适配器（内存、IndexedDB）
  - 并行请求
  - 串行请求
  - 幂等请求
  - 使用自定义适配器（Axios）

### 开发指南

- **[工程化工具](./engineering-tools.md)** - 项目使用的工程化工具配置和使用说明
  - 构建工具（Vite）
  - 包管理工具（pnpm）
  - Biome（代码格式化和 lint）
  - Commitlint（Commit 消息规范）
  - Husky（Git hooks）
  - Lint-staged（暂存文件检查）
  - 测试框架（Vitest）配置
  - 工作流程和开发规范

- **[架构设计](./architecture.md)** - 项目架构设计和适配器开发指南
  - 分层架构说明
  - 依赖倒置原则
  - 适配器开发指南

- **[测试](./testing.md)** - 测试相关文档
  - 测试结构
  - 运行测试
  - 测试最佳实践
  - 测试示例
